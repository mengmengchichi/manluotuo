"use strict";define(["cookie"],function(c){function t(){this.index=0}return t.prototype.writeid=function(){this.ali=$(".content_wrap").find("ul li a");for(var t=0;t<this.ali.length;t++)this.ali.eq(t).attr("id",t+1);this.ali.on("click",function(t){t.preventDefault(),$(location).attr("href","/html/detail.html?"+this.id)})},t.prototype.indexToDetail=function(n,t){var e=this;$.get("http://localhost/www/php/detail.php",{id:t},function(t){(t=JSON.parse(t))[0].small_preview_url1=t[0].small_preview_url1.split("&"),t[0].jianjie_url1=t[0].jianjie_url1.split("&"),console.log(t[0]);var i=n("detail",{data:t[0]});$("#content_wrap").html(i),$(".tab").find("p").on("click",function(){$(".tab>div").eq($(this).index()).addClass("show").siblings().removeClass("show")}),e.preview(),e.tocart()})},t.prototype.preview=function(){var t=this,i=$(".small_preview li").length;$(".small_preview li").on("click",function(){$(".big_preview img").attr("src",$(this).find("img").attr("src"))}),$("#prev").on("click",function(){t.index--,t.index<0&&(t.index=i-1),$(".big_preview img").attr("src",$(".small_preview li").eq(t.index).find("img").attr("src"))}),$("#next").on("click",function(){t.index++,t.index>=i&&(t.index=0),$(".big_preview img").attr("src",$(".small_preview li").eq(t.index).find("img").attr("src"))})},t.prototype.tocart=function(){var i=$("#quantity").find("span"),t=$("#nowprice").html().length,l=parseFloat($("#nowprice").html().substring(1,t-1));$("#quantity a").on("click",function(){var t=$("#count").val();0==$(this).index()?(--t<1&&(t=1),$("#count").val(t),i.html("￥"+t*l+"元")):(99<++t&&(t=99),$("#count").val(t),i.html("￥"+t*l+".00元"))}),$("#count").on("blur",function(){i.html("￥"+$(this).val()*l+".00元")}),$("#cartaction a").on("click",function(t){if(t.preventDefault(),0==$(this).index()){for(var i=c.getCookie("cookie"),n=""==i?[]:JSON.parse(i),e=0;e<n.length;e++)if(n[e].id==location.search.substr(1)){n[e].count=$("#count").val(),c.setCookie("cookie",JSON.stringify(n));var o=location.search.substr(1);return void $(location).attr("href","/html/cart.html?"+o+"&"+$("#count").val())}var r={id:location.search.substr(1),price:l,count:$("#count").val()};n.push(r);var a=JSON.stringify(n);c.setCookie("cookie",a);o=location.search.substr(1);$(location).attr("href","/html/cart.html?"+o+"&"+$("#count").val())}})},new t});