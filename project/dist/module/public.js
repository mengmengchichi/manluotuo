"use strict";define(["listload","cookie","template","lunbo","listload"],function(i,p,o,n,e){function a(){this.flag=!0,this.template=o,this.indexpage=1}return a.prototype.init=function(e,a){var t=this;$("#header").load("/html/header.html",function(){a&&$("#lunboshow").load("/html/lunbo.html",function(){n.init()}),$("#search").on("click",function(e){e.preventDefault();var a=$("#keywords").val();$(location).attr("href","/html/list.html?act=search&keywords="+a)}),i.listClick(),t.index(e)}),$("#footer").load("/html/footer.html")},a.prototype.index=function(r){$("#cart").hover(function(){var e=p.getCookie("cookie"),n=""==e?[]:JSON.parse(e);if(0!=n.length){for(var a=0,t={},i=[],o=0;o<n.length;o++)i[o]=n[o].id,a+=parseInt(n[o].count);console.log(a),$("#thingcount").html(a),t.act="cart",t.id=i,$.get("http://localhost/www/php/detail.php",t,function(e){e=JSON.parse(e);for(var a=0;a<e.length;a++)for(var t=0;t<n.length;t++)e[a].id===n[t].id&&(e[a].count=n[t].count);console.log(e);var i=r("showcartcon",{data:e});$("#showcart").html(i)})}else{$("#showcart").html("<li>您的购物车暂无商品 赶快选择心爱的产品吧<li>")}},function(){$("#showcart").html("")})},a.prototype.search=function(e,a){var n=this,t={keywords:e,act:"search",pageCount:12,index:n.indexpage};$.get("http://localhost/www/php/detail.php",t,function(e){var a,t=(e=JSON.parse(e)).length;a=Math.ceil(t/12),console.log(e);var i=o("list",{data:e});$("#content_con_goods").html(i),n.listsearch(n.template,a,$("#search"))})},a.prototype.listsearch=function(e,a,t){var i=this,n="";if(i.flag){n+='<a href="javascript:;" id="goprev">上一页</a>';for(var o=1;o<=a;o++)n+=1==o?'<a href="javascript:;" class = "pageclick">'+o+"</a>":'<a href="javascript:;">'+o+"</a>";n+='<a href="javascript:;" id="gonext">下一页</a>',$("#pagechange").html(n),i.indexpage==a?$("#gonext").replaceWith('<span id="gonext">下一页</span>'):$("#gonext").replaceWith('<a href="javascript:;" id="gonext">下一页</a>'),1==i.indexpage?$("#goprev").replaceWith('<span id = "goprev">上一页</span>'):$("#goprev").replaceWith('<a href="javascript:;" id="goprev">上一页</a>'),i.listchange(a,e,t),i.flag=!1}},a.prototype.listchange=function(a,t,i){var n=this;$("#pagechange a").on("click",function(){var e=this.innerHTML;isNaN(Number(e))?"goprev"===this.id?(n.indexpage--,n.indexpage<1&&(n.indexpage=1),$("#pagechange a").eq(n.indexpage).addClass("pageclick").siblings().removeClass("pageclick"),1==n.indexpage?$(this).replaceWith('<span id="goprev">上一页</span>'):($("#gonext").replaceWith('<a href="javascript:;" id="gonext">下一页</a>'),$(this).replaceWith('<a href="javascript:;" id="goprev">上一页</a>'),n.listchange(a,t,i))):"gonext"===this.id&&(n.indexpage++,n.indexpage>a&&(n.indexpage=a),$("#pagechange").children().eq(n.indexpage).addClass("pageclick").siblings().removeClass("pageclick"),n.indexpage==a?$(this).replaceWith('<span id="gonext">下一页</span>'):($(this).replaceWith('<a href="javascript:;" id="gonext">下一页</a>'),$("#goprev").replaceWith('<a href="javascript:;" id="goprev">上一页</a>'),n.listchange(a,t,i))):(n.indexpage=Number(e),$(this).addClass("pageclick").siblings().removeClass("pageclick"),n.indexpage==a?$("#gonext").replaceWith('<span id="gonext">下一页</span>'):1==n.indexpage?$("#goprev").replaceWith('<span id = "goprev">上一页</span>'):($("#goprev").replaceWith('<a href="javascript:;" id="goprev">上一页</a>'),$("#gonext").replaceWith('<a href="javascript:;" id="gonext">下一页</a>'),n.listchange(a,t,i))),n.search(t,i)})},new a});